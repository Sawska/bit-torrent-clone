cmake_minimum_required(VERSION 3.10)
project(Tracker)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED True)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -stdlib=libc++")

find_package(Boost 1.70 REQUIRED COMPONENTS system filesystem)
find_package(SQLite3 REQUIRED)
find_package(OpenSSL REQUIRED)

# Set JSON include directory
set(JSON_INCLUDE_DIR "/opt/homebrew/opt/nlohmann-json/include")

# List of source files
set(SOURCES
    main.cpp
    tracker.cpp
    torrent.cpp
    seeder.cpp
    http_session.cpp 
)

include_directories(${Boost_INCLUDE_DIRS} ${SQLite3_INCLUDE_DIRS} ${JSON_INCLUDE_DIR} /opt/homebrew/opt/openssl/include)

add_executable(tracker ${SOURCES})

# Link required libraries
target_link_libraries(tracker 
                      ${Boost_LIBRARIES} 
                      ${SQLite3_LIBRARIES} 
                      OpenSSL::Crypto
                      OpenSSL::SSL
                      /opt/homebrew/opt/openssl/lib/libssl.dylib
                      /opt/homebrew/opt/openssl/lib/libcrypto.dylib)
